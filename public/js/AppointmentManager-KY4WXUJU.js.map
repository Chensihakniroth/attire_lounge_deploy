{
  "version": 3,
  "sources": ["../../resources/js/components/pages/admin/AppointmentManager.jsx"],
  "sourcesContent": ["import React, { useState, useEffect, useContext } from 'react';\nimport { User, Mail, Phone, Calendar, Clock, MessageSquare, AlertTriangle, Loader, Check, X, Trash2 } from 'lucide-react';\nimport { ThemeContext } from './ThemeContext';\nimport { useAdmin } from './AdminContext';\n\nconst AppointmentRow = ({ appointment, onUpdateStatus, colors }) => {\n    const statusStyles = {\n        pending: { borderLeft: `4px solid ${colors.border}`, backgroundColor: colors.card },\n        done: { borderLeft: '4px solid #22c55e', backgroundColor: colors.card },\n        cancelled: { borderLeft: '4px solid #ef4444', backgroundColor: colors.card },\n    };\n\n    return (\n        <div\n            style={statusStyles[appointment.status]} \n            className=\"p-5 rounded-xl shadow-md transition duration-200 ease-out hover:scale-[1.01] hover:shadow-xl border border-gray-700/30 hover:border-gray-600/50\"\n        >\n            <div style={{borderColor: colors.border}} className=\"flex justify-between items-center pb-3 mb-3 border-b\">\n                <div className=\"flex items-center\">\n                    <User style={{color: colors.primary}} className=\"w-5 h-5 mr-3\" />\n                    <h3 style={{color: colors.mainText}} className=\"text-lg font-semibold\">{appointment.name}</h3>\n                </div>\n                <span style={{backgroundColor: colors.background, color: colors.sidebarText}} className=\"text-xs font-bold uppercase px-3 py-1 rounded-full\">{appointment.status}</span>\n            </div>\n\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n                <div className=\"md:col-span-1 space-y-4\">\n                    <div style={{color: colors.sidebarText}} className=\"flex items-center\">\n                        <Mail className=\"w-4 h-4 mr-3 flex-shrink-0\" />\n                        <a href={`mailto:${appointment.email}`} style={{color: colors.primary}} className=\"hover:underline truncate text-sm\">{appointment.email}</a>\n                    </div>\n                    <div style={{color: colors.sidebarText}} className=\"flex items-center\">\n                        <Phone className=\"w-4 h-4 mr-3 flex-shrink-0\" />\n                        <span className=\"text-sm\">{appointment.phone}</span>\n                    </div>\n                    <div style={{borderColor: colors.border}} className=\"flex items-center text-gray-600 pt-2 border-t mt-2\">\n                        <Calendar className=\"w-4 h-4 mr-3 flex-shrink-0\" />\n                        <span className=\"text-sm font-medium\">{new Date(appointment.date).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })} at {appointment.time}</span>\n                    </div>\n                </div>\n\n                <div className=\"md:col-span-2 space-y-4\">\n                    <div>\n                        <p style={{color: colors.mainText}} className=\"font-semibold text-sm mb-1\">Service Requested</p>\n                        <p style={{color: colors.sidebarText}} className=\"text-sm\">{appointment.service}</p>\n                    </div>\n                    {appointment.message && (\n                        <div>\n                             <p style={{color: colors.mainText}} className=\"font-semibold text-sm mb-1\">Message</p>\n                            <div style={{color: colors.sidebarText}} className=\"flex items-start text-sm\">\n                                <MessageSquare className=\"w-4 h-4 mr-3 mt-0.5 flex-shrink-0\" />\n                                <p className=\"italic\">{appointment.message}</p>\n                            </div>\n                        </div>\n                    )}\n                </div>\n            </div>\n\n            {appointment.favorite_item_image_url && appointment.favorite_item_image_url.length > 0 && (\n                <div className=\"mt-4 pt-4 border-t\">\n                    <h4 style={{color: colors.sidebarText}} className=\"text-sm font-semibold mb-2\">Selected Items</h4>\n                    <div className=\"flex flex-wrap gap-3\">\n                        {appointment.favorite_item_image_url.map((imageUrl, index) => (\n                            <img\n                                key={index}\n                                src={imageUrl}\n                                alt={`Favorite Item ${index + 1}`}\n                                style={{borderColor: colors.border}}\n                                className=\"w-16 h-16 object-cover rounded-lg shadow-sm border\"\n                            />\n                        ))}\n                    </div>\n                </div>\n            )}\n\n            <div style={{borderColor: colors.border}} className=\"mt-4 pt-4 border-t flex justify-end space-x-2\">\n                <button onClick={() => onUpdateStatus(appointment.id, 'done')} disabled={appointment.status === 'done'} className=\"px-3 py-1.5 text-xs font-semibold text-green-800 bg-green-100 rounded-md hover:bg-green-200 disabled:opacity-60 disabled:cursor-not-allowed flex items-center\"><Check className=\"w-4 h-4 mr-1\" /> Mark as Done</button>\n                <button onClick={() => onUpdateStatus(appointment.id, 'cancelled')} disabled={appointment.status === 'cancelled'} className=\"px-3 py-1.5 text-xs font-semibold text-red-800 bg-red-100 rounded-md hover:bg-red-200 disabled:opacity-60 disabled:cursor-not-allowed flex items-center\"><X className=\"w-4 h-4 mr-1\" /> Cancel</button>\n            </div>\n        </div>\n    );\n};\n\nconst AppointmentManager = () => {\n    const { colors } = useContext(ThemeContext);\n    const { \n        appointments, \n        appointmentsLoading, \n        fetchAppointments, \n        updateAppointmentStatus, \n        clearCompletedAppointments \n    } = useAdmin();\n\n    useEffect(() => {\n        fetchAppointments(); // Use context fetcher which handles caching\n        const intervalId = setInterval(() => fetchAppointments(false), 60000); \n        return () => clearInterval(intervalId);\n    }, [fetchAppointments]);\n\n    const handleUpdateStatus = async (id, status) => {\n        try {\n            await updateAppointmentStatus(id, status);\n        } catch (err) {\n            alert('Failed to update status. Please try again.');\n        }\n    };\n\n    const handleClearCompleted = async () => {\n        if (window.confirm('Are you sure you want to clear all \"done\" appointments? This action cannot be undone.')) {\n            try {\n                await clearCompletedAppointments();\n            } catch (err) {\n                alert('Failed to clear completed appointments. Please try again.');\n            }\n        }\n    };\n\n    const renderContent = () => {\n        if (appointmentsLoading && appointments.length === 0) {\n            return <div className=\"flex justify-center items-center h-64\"><Loader style={{color: colors.primary}} className=\"animate-spin\" size={48} /></div>;\n        }\n\n        // Context handles errors by just not updating, or we could add error state to context. \n        // For now, if no appointments and not loading, assume empty or error handled elsewhere (or logged).\n        \n        if (appointments.length === 0 && !appointmentsLoading) {\n             return <p style={{color: colors.sidebarText}} className=\"text-center\">No appointments found.</p>;\n        }\n\n        return (\n            <div className=\"space-y-4\">\n                {appointments.map(app => {\n                    // Parse image URL logic moved here for display\n                    let imageUrls = [];\n                    try {\n                        if (typeof app.favorite_item_image_url === 'string') {\n                            const parsed = JSON.parse(app.favorite_item_image_url);\n                            imageUrls = Array.isArray(parsed) ? parsed : [];\n                        } else if (Array.isArray(app.favorite_item_image_url)) {\n                            imageUrls = app.favorite_item_image_url;\n                        }\n                    } catch (e) {\n                         // console.error('Failed to parse favorite_item_image_url:', e);\n                    }\n                    const appointmentWithImages = { ...app, favorite_item_image_url: imageUrls };\n                    \n                    return (\n                        <AppointmentRow \n                            key={app.id} \n                            appointment={appointmentWithImages} \n                            onUpdateStatus={handleUpdateStatus} \n                            colors={colors} \n                        />\n                    );\n                })}\n            </div>\n        );\n    };\n\n    return (\n        <div className=\"space-y-6\">\n            <div className=\"flex justify-between items-center\">\n                <div>\n                    <h1 style={{color: colors.mainText}} className=\"text-3xl font-bold\">Appointment Requests</h1>\n                    <p style={{color: colors.sidebarText}} className=\"mt-1\">Manage incoming appointment requests from customers.</p>\n                </div>\n                <button\n                    onClick={handleClearCompleted}\n                    className=\"flex items-center px-4 py-2 text-sm font-medium text-gray-400 bg-gray-800 border border-gray-700 rounded-lg hover:text-red-400 hover:border-red-400/50 hover:bg-red-500/10 transition-all duration-200 shadow-sm active:scale-95 group\"\n                >\n                    <Trash2 className=\"w-4 h-4 mr-2 text-gray-500 group-hover:text-red-400 transition-colors\" />\n                    Clear All\n                </button>\n            </div>\n            {renderContent()}\n        </div>\n    );\n};\n\nexport default AppointmentManager;"],
  "mappings": "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",
  "names": ["React"]
}
