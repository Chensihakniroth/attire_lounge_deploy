{
  "version": 3,
  "sources": ["../../resources/js/components/pages/admin/AdminContext.jsx"],
  "sourcesContent": ["import React, { createContext, useState, useContext, useCallback } from 'react';\nimport axios from 'axios';\n\nconst AdminContext = createContext();\n\nexport const useAdmin = () => useContext(AdminContext);\n\nexport const AdminProvider = ({ children }) => {\n    // State for Appointments\n    const [appointments, setAppointments] = useState([]);\n    const [appointmentsLoaded, setAppointmentsLoaded] = useState(false);\n    const [appointmentsLoading, setAppointmentsLoading] = useState(false);\n\n    // State for Gift Requests\n    const [giftRequests, setGiftRequests] = useState([]);\n    const [giftRequestsLoaded, setGiftRequestsLoaded] = useState(false);\n    const [giftRequestsLoading, setGiftRequestsLoading] = useState(false);\n\n    // Global Stats (derived or fetched)\n    const [stats, setStats] = useState({ appointments: 0, gifts: 0 });\n\n    // --- Appointments Logic ---\n    const fetchAppointments = useCallback(async (forceRefresh = false) => {\n        // If we already have data and aren't forcing a refresh, just return (or fetch in background)\n        if (appointmentsLoaded && !forceRefresh) {\n            // Background update (stale-while-revalidate)\n            fetchAppointmentsBackground();\n            return;\n        }\n\n        setAppointmentsLoading(true);\n        try {\n            const response = await axios.get('/api/v1/admin/appointments');\n            // Assuming backend already sorts, but we can ensure consistency here if needed\n            setAppointments(response.data);\n            setAppointmentsLoaded(true);\n            updateStats({ appointments: response.data.length });\n        } catch (err) {\n            console.error('Error fetching appointments:', err);\n        } finally {\n            setAppointmentsLoading(false);\n        }\n    }, [appointmentsLoaded]);\n\n    const fetchAppointmentsBackground = async () => {\n        try {\n            const response = await axios.get('/api/v1/admin/appointments');\n            setAppointments(response.data);\n            updateStats({ appointments: response.data.length });\n        } catch (err) {\n            console.error('Error refreshing appointments:', err);\n        }\n    };\n\n    const updateAppointmentStatus = async (id, status) => {\n        // Optimistic update\n        const previous = [...appointments];\n        setAppointments(prev => prev.map(app => app.id === id ? { ...app, status } : app));\n\n        try {\n            await axios.patch(`/api/v1/admin/appointments/${id}/status`, { status });\n            // Optionally update with server response\n        } catch (err) {\n            console.error('Failed to update status:', err);\n            setAppointments(previous); // Revert\n            throw err;\n        }\n    };\n\n    const clearCompletedAppointments = async () => {\n        const previous = [...appointments];\n        setAppointments(prev => prev.filter(app => app.status !== 'done'));\n        try {\n            await axios.post('/api/v1/admin/appointments/clear-completed');\n        } catch (err) {\n            setAppointments(previous);\n            throw err;\n        }\n    };\n\n    // --- Gift Requests Logic ---\n    const fetchGiftRequests = useCallback(async (forceRefresh = false) => {\n        if (giftRequestsLoaded && !forceRefresh) {\n            fetchGiftRequestsBackground();\n            return;\n        }\n\n        setGiftRequestsLoading(true);\n        try {\n            const response = await axios.get('/api/v1/gift-requests');\n            setGiftRequests(response.data);\n            setGiftRequestsLoaded(true);\n            updateStats({ gifts: response.data.length });\n        } catch (err) {\n            console.error('Error fetching gift requests:', err);\n        } finally {\n            setGiftRequestsLoading(false);\n        }\n    }, [giftRequestsLoaded]);\n\n    const fetchGiftRequestsBackground = async () => {\n        try {\n            const response = await axios.get('/api/v1/gift-requests');\n            setGiftRequests(response.data);\n            updateStats({ gifts: response.data.length });\n        } catch (err) {\n            console.error('Error refreshing gift requests:', err);\n        }\n    };\n\n    const updateGiftRequestStatus = async (id, status) => {\n        const previous = [...giftRequests];\n        setGiftRequests(prev => prev.map(req => req.id === id ? { ...req, status } : req));\n        try {\n            await axios.patch(`/api/v1/gift-requests/${id}/status`, { status });\n        } catch (err) {\n            setGiftRequests(previous);\n            throw err;\n        }\n    };\n\n    const deleteGiftRequest = async (id) => {\n        const previous = [...giftRequests];\n        setGiftRequests(prev => prev.filter(req => req.id !== id));\n        try {\n            await axios.delete(`/api/v1/gift-requests/${id}`);\n        } catch (err) {\n            setGiftRequests(previous);\n            throw err;\n        }\n    };\n\n    // --- Stats Helper ---\n    const updateStats = (newStats) => {\n        setStats(prev => ({ ...prev, ...newStats }));\n    };\n\n    return (\n        <AdminContext.Provider value={{\n            appointments,\n            appointmentsLoading,\n            fetchAppointments,\n            updateAppointmentStatus,\n            clearCompletedAppointments,\n            \n            giftRequests,\n            giftRequestsLoading,\n            fetchGiftRequests,\n            updateGiftRequestStatus,\n            deleteGiftRequest,\n\n            stats\n        }}>\n            {children}\n        </AdminContext.Provider>\n    );\n};\n"],
  "mappings": "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",
  "names": ["import_react", "AdminContext", "useAdmin", "AdminProvider", "children", "appointments", "setAppointments", "appointmentsLoaded", "setAppointmentsLoaded", "appointmentsLoading", "setAppointmentsLoading", "giftRequests", "setGiftRequests", "giftRequestsLoaded", "setGiftRequestsLoaded", "giftRequestsLoading", "setGiftRequestsLoading", "stats", "setStats", "fetchAppointments", "forceRefresh", "fetchAppointmentsBackground", "response", "axios_default", "updateStats", "err", "updateAppointmentStatus", "id", "status", "previous", "prev", "app", "clearCompletedAppointments", "fetchGiftRequests", "fetchGiftRequestsBackground", "updateGiftRequestStatus", "req", "deleteGiftRequest", "newStats", "React"]
}
